<form (ngSubmit)="onSubmit(signUpForm)" #signUpForm="ngForm" novalidate>
  <h1>Konto erstellen</h1>

  @if (authService.error()) {
    <div class="error-message" role="alert" aria-live="polite">
      {{ authService.error() }}
    </div>
  }

  <div class="form-group">
    <input
      id="firstName"
      type="text"
      placeholder="Vorname"
      [(ngModel)]="userData.firstName"
      name="firstName"
      required
      minlength="2"
      #firstNameInput="ngModel"
      [class.error]="firstNameInput.invalid && firstNameInput.touched"
      autocomplete="given-name"
      aria-describedby="firstName-error" />

    @if (firstNameInput.invalid && firstNameInput.touched) {
      <div id="firstName-error" class="field-error" role="alert">
        @if (firstNameInput.errors?.['required']) {
          Vorname ist erforderlich
        }
        @if (firstNameInput.errors?.['minlength']) {
          Vorname muss mindestens 2 Zeichen lang sein
        }
      </div>
    }
  </div>

  <div class="form-group">
    <input
      id="lastName"
      type="text"
      placeholder="Nachname"
      [(ngModel)]="userData.lastName"
      name="lastName"
      required
      minlength="2"
      #lastNameInput="ngModel"
      [class.error]="lastNameInput.invalid && lastNameInput.touched"
      autocomplete="family-name"
      aria-describedby="lastName-error" />

    @if (lastNameInput.invalid && lastNameInput.touched) {
      <div id="lastName-error" class="field-error" role="alert">
        @if (lastNameInput.errors?.['required']) {
          Nachname ist erforderlich
        }
        @if (lastNameInput.errors?.['minlength']) {
          Nachname muss mindestens 2 Zeichen lang sein
        }
      </div>
    }
  </div>

  <div class="form-group">
    <input
      id="email"
      type="email"
      placeholder="E-Mail"
      [(ngModel)]="userData.email"
      name="email"
      required
      email
      #emailInput="ngModel"
      [class.error]="emailInput.invalid && emailInput.touched"
      autocomplete="email"
      aria-describedby="email-error" />

    @if (emailInput.invalid && emailInput.touched) {
      <div id="email-error" class="field-error" role="alert">
        @if (emailInput.errors?.['required']) {
          E-Mail ist erforderlich
        }
        @if (emailInput.errors?.['email']) {
          Ung√ºltige E-Mail-Adresse
        }
      </div>
    }
  </div>

  <div class="form-group">
    <input
      id="password"
      type="password"
      placeholder="Passwort"
      [(ngModel)]="userData.password"
      name="password"
      required
      minlength="6"
      #passwordInput="ngModel"
      [class.error]="passwordInput.invalid && passwordInput.touched"
      autocomplete="new-password"
      aria-describedby="password-error" />

    @if (passwordInput.invalid && passwordInput.touched) {
      <div id="password-error" class="field-error" role="alert">
        @if (passwordInput.errors?.['required']) {
          Passwort ist erforderlich
        }
        @if (passwordInput.errors?.['minlength']) {
          Passwort muss mindestens 6 Zeichen lang sein
        }
      </div>
    }
  </div>

  <p>

  <button
    type="submit"
    [disabled]="signUpForm.invalid || authService.loading()"
    [attr.aria-disabled]="signUpForm.invalid || authService.loading() ? 'true' : 'false'">
    @if (authService.loading()) {
      <span class="spinner"></span> Registrieren...
    } @else {
      Registrieren
    }
  </button>
</form>
