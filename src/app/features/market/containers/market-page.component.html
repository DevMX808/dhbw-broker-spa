<div class="market-page">
  <div class="page-header mb-4">
    <h1 class="page-greeting"><span>Hallo</span>, {{ firstName }} {{ lastName }}.</h1>

    <div class="market-hint">
      <span class="info-icon">i</span>
      Diese Alexa-Demo repliziert die Sprachausgabe. Sowohl die echte Alexa-Skill-Integration als auch diese Demo nutzen den BFF-Endpunkt, der via GraphQL auf die Datenbank zugreift. Der echte Alexa Skill ist über die Amazon Developer Console erreichbar und kann dort getestet werden.
    </div>

    <div class="alexa-panel">
      <div class="alexa-left">
        <div class="alexa-title">Alexa Demo</div>
        <p class="alexa-text">
          Löst den BFF-Alexa-Endpunkt aus und liest die aktuellen Marktpreise oder ein einzelnes Asset.
        </p>

        <div class="alexa-grid">
          <button
            class="btn btn-secondary alexa-full-btn"
            (click)="onAlexaAll()"
            [disabled]="alexaLoading">
            Alle Marktpreise abrufen
          </button>

          <div class="alexa-row">
            <input
              class="form-control"
              type="text"
              placeholder="z. B. Gold, BTC, ETH"
              [(ngModel)]="alexaAsset" />
            <button
              class="btn btn-secondary"
              (click)="onAlexaSingle()"
              [disabled]="alexaLoading">
              Einzelnes Asset
            </button>
          </div>

          <div class="alexa-row alexa-row-split">
            <button
              class="btn btn-secondary"
              type="button"
              (click)="onAlexaRepeat()"
              [disabled]="!alexaOutput">
              Noch einmal abspielen
            </button>
            <button
              class="btn btn-secondary"
              type="button"
              (click)="onAlexaStop()"
              [disabled]="!alexaSpeaking">
              Sprachausgabe stoppen
            </button>
          </div>
        </div>
      </div>

      <div class="alexa-right">
        <div class="alexa-output-title">Alexa Antwort</div>

        <div *ngIf="alexaLoading" class="alexa-loading">
          Wird abgefragt...
        </div>
        <div *ngIf="alexaError" class="alexa-error">
          {{ alexaError }}
        </div>
        <div *ngIf="!alexaLoading && !alexaError && alexaOutput" class="alexa-output">
          {{ alexaOutput }}
        </div>
        <div *ngIf="!alexaLoading && !alexaError && !alexaOutput" class="alexa-placeholder">
          Noch keine Ausgabe.
        </div>
      </div>
    </div>
  </div>

  <div class="market-hint market-hint-assets">
    <span class="info-icon">i</span>
    Durch Auswahl eines Assets können Sie den Kursverlauf einsehen und einen Kauf zum aktuellen Marktpreis tätigen. Die Kurse werden minütlich aktualisiert. Bei geschlossenen Märkten werden die letzten verfügbaren Kurse fortgeschrieben.
  </div>

  <app-market-list
    [symbols]="store.symbols()"
    [pricesBySymbol]="store.pricesBySymbol()"
    [loading]="store.loading().symbols"
    [error]="store.error()"
    [loadingPrices]="store.loading().priceBySymbol"
    (retry)="onRetry()">
  </app-market-list>
</div>
