import{a as X}from"./chunk-FC6PIBBV.js";import{b as N,c as w,d as U,e as z,f as u,o as q,q as K,r as L}from"./chunk-GBTQ25J6.js";import{Ba as M,Ga as v,Ia as l,Ja as $,K as j,La as o,Ma as r,Na as S,Oa as I,P as V,Ra as b,Sa as m,V as _,X as g,Xa as a,Ya as P,Za as c,a as h,b as x,c as p,cb as f,db as H,ea as E,eb as T,fa as D,fb as F,i as B,ka as k,rb as C,va as s}from"./chunk-GMUHQ275.js";var R=(()=>{class t{adapter=_(X);symbols=M([]);pricesBySymbol=M({});selectedSymbol=M(null);loading=M({symbols:!1,priceBySymbol:{}});error=M(null);lastFetched={};pendingRequests={};hasData=C(()=>this.symbols().length>0);selectedPrice=C(()=>{let e=this.selectedSymbol();return e?this.pricesBySymbol()[e]:null});loadSymbols(){return p(this,null,function*(){if(!this.loading().symbols){this.loading.update(e=>x(h({},e),{symbols:!0})),this.error.set(null);try{let e=yield this.adapter.fetchSymbols();this.symbols.set(e),this.error.set(null)}catch(e){console.error("[MarketStore] loadSymbols failed",e),this.error.set("Symbols konnten nicht geladen werden.")}finally{this.loading.update(e=>x(h({},e),{symbols:!1}))}}})}loadPrice(e,i=!1){return p(this,null,function*(){if(this.loading().priceBySymbol[e]&&!i||!i&&this.isCached(e))return;let n=this.pendingRequests[e];if(n&&!i){yield n;return}this.loading.update(y=>x(h({},y),{priceBySymbol:x(h({},y.priceBySymbol),{[e]:!0})}));let O=this.adapter.fetchPrice(e);this.pendingRequests[e]=O;try{let y=yield O;this.pricesBySymbol.update(ee=>x(h({},ee),{[e]:y})),this.lastFetched[e]=Date.now()}catch(y){console.error(`[MarketStore] loadPrice failed for ${e}`,y)}finally{this.loading.update(y=>x(h({},y),{priceBySymbol:x(h({},y.priceBySymbol),{[e]:!1})})),this.pendingRequests[e]=void 0}})}selectSymbol(e){return p(this,null,function*(){this.selectedSymbol.set(e),yield this.loadPrice(e)})}refreshPrice(e){return p(this,null,function*(){yield this.loadPrice(e,!0)})}prefetchPrices(e){return p(this,null,function*(){let i=e.map(n=>this.loadPrice(n));yield Promise.allSettled(i)})}isCached(e){let n=this.lastFetched[e];return!n||!this.pricesBySymbol()[e]?!1:Date.now()-n<6e4}isLoadingPrice(e){return this.loading().priceBySymbol[e]??!1}static \u0275fac=function(i){return new(i||t)};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function te(t,d){t&1&&(o(0,"div",11),S(1,"div",12)(2,"div",13),r())}function ne(t,d){if(t&1&&(o(0,"div")(1,"div",14),a(2),T(3,"number"),o(4,"span",15),a(5,"USD"),r()(),o(6,"div",16),a(7),r()()),t&2){let e=m();s(2),c(" ",F(3,2,e.price.price,"1.2-4")," "),s(5),c(" ",e.price.updatedAtReadable," ")}}function ie(t,d){t&1&&(o(0,"div",17)(1,"span"),a(2,"\u2014"),r()())}var Y=(()=>{class t{symbol;price;loading=!1;select=new k;getSymbolIcon(e){return{XAG:"\u{1F948}",XAU:"\u{1F947}",BTC:"\u20BF",ETH:"\u039E",XPD:"\u{1F48E}",HG:"\u{1F527}"}[e]||"\u25C8"}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=g({type:t,selectors:[["app-market-card"]],inputs:{symbol:"symbol",price:"price",loading:"loading"},outputs:{select:"select"},standalone:!0,features:[f],decls:15,vars:8,consts:[[1,"card","h-100","market-card"],[1,"card-body"],[1,"d-flex","align-items-center","mb-3"],[1,"symbol-icon","mr-2"],[1,"flex-grow-1"],[1,"card-title","mb-0"],[1,"symbol-ticker","text-muted","text-uppercase"],[1,"price-section"],["class","skeleton-loader",4,"ngIf"],[4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"skeleton-loader"],[1,"skeleton-box","mb-1",2,"height","28px","width","60%"],[1,"skeleton-box",2,"height","16px","width","40%"],[1,"price-value"],[1,"price-currency"],[1,"price-updated","text-muted","small"],[1,"text-muted"]],template:function(i,n){i&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span"),a(5),r()(),o(6,"div",4)(7,"h3",5),a(8),r(),o(9,"div",6),a(10),r()()(),o(11,"div",7),v(12,te,3,0,"div",8)(13,ne,8,5,"div",9)(14,ie,3,0,"div",10),r()()()),i&2&&($("market-card--loading",n.loading),s(5),P(n.getSymbolIcon(n.symbol.symbol)),s(3),P(n.symbol.name),s(2),c(" ",n.symbol.symbol," "),s(2),l("ngIf",n.loading),s(),l("ngIf",!n.loading&&n.price),s(),l("ngIf",!n.loading&&!n.price))},dependencies:[u,w,z],styles:[".market-card[_ngcontent-%COMP%]{cursor:pointer;transition:all .2s ease;border:1px solid #e0e0e0;box-shadow:0 1px 3px #00000014}.market-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #00000026;transform:translateY(-2px)}.market-card--loading[_ngcontent-%COMP%]{opacity:.7}.symbol-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg,#667eea,#764ba2);display:flex;align-items:center;justify-content:center;font-size:18px;color:#fff;flex-shrink:0}.card-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;margin:0;line-height:1.3}.symbol-ticker[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600;letter-spacing:.05em;margin-top:2px}.price-section[_ngcontent-%COMP%]{min-height:60px;display:flex;flex-direction:column;justify-content:center}.price-value[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;line-height:1.2;font-family:Courier New,monospace}.price-currency[_ngcontent-%COMP%]{font-size:.9rem;font-weight:400;color:#666;margin-left:4px}.price-updated[_ngcontent-%COMP%]{margin-top:4px;font-size:.8rem}.skeleton-loader[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 1.5s ease-in-out infinite}.skeleton-box[_ngcontent-%COMP%]{background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_loading 1.5s infinite;border-radius:4px}@keyframes _ngcontent-%COMP%_loading{0%{background-position:200% 0}to{background-position:-200% 0}}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.6}}"]})}return t})();var re=t=>["/market",t];function oe(t,d){t&1&&(o(0,"div",5)(1,"div",6)(2,"div",7),S(3,"div",8)(4,"div",9)(5,"div",10),r()()())}function ae(t,d){if(t&1&&(o(0,"div",3),v(1,oe,6,0,"div",4),r()),t&2){let e=m();s(),l("ngForOf",e.skeletonArray)}}function se(t,d){if(t&1){let e=I();o(0,"div",11)(1,"div")(2,"strong"),a(3,"\u26A0\uFE0F Fehler:"),r(),a(4),r(),o(5,"button",12),b("click",function(){E(e);let n=m();return D(n.onRetry())}),a(6," Erneut versuchen "),r()()}if(t&2){let e=m();s(4),c(" ",e.error," ")}}function le(t,d){t&1&&(o(0,"div",13)(1,"div",14),a(2,"\u{1F4CA}"),r(),o(3,"h3"),a(4,"Keine Symbole verf\xFCgbar"),r(),o(5,"p",15),a(6,"Derzeit sind keine handelbaren Symbole verf\xFCgbar."),r()())}function de(t,d){if(t&1&&(o(0,"div",5)(1,"a",16),S(2,"app-market-card",17),r()()),t&2){let e=d.$implicit,i=m(2);s(),l("routerLink",H(4,re,e.symbol)),s(),l("symbol",e)("price",i.pricesBySymbol[e.symbol])("loading",i.isLoadingPrice(e.symbol))}}function me(t,d){if(t&1&&(o(0,"div",3),v(1,de,3,6,"div",4),r()),t&2){let e=m();s(),l("ngForOf",e.symbols)}}var Z=(()=>{class t{symbols=[];pricesBySymbol={};loading=!1;error=null;loadingPrices={};selectSymbol=new k;retry=new k;skeletonArray=Array(6).fill(0);isLoadingPrice(e){return this.loadingPrices[e]??!1}onRetry(){this.retry.emit()}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=g({type:t,selectors:[["app-market-list"]],inputs:{symbols:"symbols",pricesBySymbol:"pricesBySymbol",loading:"loading",error:"error",loadingPrices:"loadingPrices"},outputs:{selectSymbol:"selectSymbol",retry:"retry"},standalone:!0,features:[f],decls:4,vars:4,consts:[["class","market-grid",4,"ngIf"],["class","alert alert-danger d-flex align-items-center justify-content-between",4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"market-grid"],["class","market-grid-item",4,"ngFor","ngForOf"],[1,"market-grid-item"],[1,"card","h-100"],[1,"card-body"],[1,"skeleton-box","mb-2",2,"height","24px","width","70%"],[1,"skeleton-box","mb-3",2,"height","16px","width","40%"],[1,"skeleton-box",2,"height","32px","width","50%"],[1,"alert","alert-danger","d-flex","align-items-center","justify-content-between"],[1,"btn","btn-outline-danger","btn-sm",3,"click"],[1,"empty-state"],[1,"empty-icon"],[1,"text-muted"],[1,"card-link",3,"routerLink"],[3,"symbol","price","loading"]],template:function(i,n){i&1&&v(0,ae,2,1,"div",0)(1,se,7,1,"div",1)(2,le,7,0,"div",2)(3,me,2,1,"div",0),i&2&&(l("ngIf",n.loading),s(),l("ngIf",!n.loading&&n.error),s(),l("ngIf",!n.loading&&!n.error&&n.symbols.length===0),s(),l("ngIf",!n.loading&&!n.error&&n.symbols.length>0))},dependencies:[u,N,w,L,Y],styles:[".market-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1.5rem;margin:1.5rem 0}.market-grid-item[_ngcontent-%COMP%]{min-height:160px}.card-link[_ngcontent-%COMP%]{text-decoration:none;color:inherit;display:block;height:100%}.card-link[_ngcontent-%COMP%]:hover{text-decoration:none}.skeleton-box[_ngcontent-%COMP%]{background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_loading 1.5s infinite;border-radius:4px}@keyframes _ngcontent-%COMP%_loading{0%{background-position:200% 0}to{background-position:-200% 0}}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:4rem 2rem}.empty-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:1rem;opacity:.5}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;margin-bottom:.5rem}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem;margin-bottom:0}@media (max-width: 768px){.market-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:1rem}}@media (max-width: 576px){.market-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})}return t})();var J=(()=>{class t{store=_(R);ngOnInit(){return p(this,null,function*(){if(!this.store.hasData()){yield this.store.loadSymbols();let e=this.store.symbols().slice(0,6).map(i=>i.symbol);e.length>0&&this.store.prefetchPrices(e)}})}onRetry(){this.store.loadSymbols()}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=g({type:t,selectors:[["app-market-page"]],standalone:!0,features:[f],decls:7,vars:5,consts:[[1,"market-page"],[1,"page-header","mb-4"],[1,"page-title"],[1,"page-subtitle","text-muted"],[3,"retry","symbols","pricesBySymbol","loading","error","loadingPrices"]],template:function(i,n){i&1&&(o(0,"div",0)(1,"div",1)(2,"h1",2),a(3,"Markt"),r(),o(4,"p",3),a(5," Handelbare Symbole und aktuelle Preise "),r()(),o(6,"app-market-list",4),b("retry",function(){return n.onRetry()}),r()()),i&2&&(s(6),l("symbols",n.store.symbols())("pricesBySymbol",n.store.pricesBySymbol())("loading",n.store.loading().symbols)("error",n.store.error())("loadingPrices",n.store.loading().priceBySymbol))},dependencies:[u,Z],styles:[".market-page[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;padding:2rem 1rem}.page-header[_ngcontent-%COMP%]{margin-bottom:2rem}.page-title[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;margin-bottom:.5rem;color:#333}.page-subtitle[_ngcontent-%COMP%]{font-size:1rem;margin-bottom:0}@media (max-width: 768px){.market-page[_ngcontent-%COMP%]{padding:1.5rem 1rem}.page-title[_ngcontent-%COMP%]{font-size:1.5rem}}"]})}return t})();function ce(t,d){t&1&&(o(0,"div",2)(1,"div",3),S(2,"div",4)(3,"div",5)(4,"div",6),r()())}function pe(t,d){if(t&1){let e=I();o(0,"div",7)(1,"div",3)(2,"div",8)(3,"span",9),a(4,"\u26A0\uFE0F"),r(),o(5,"h5",10),a(6,"Fehler"),r()(),o(7,"p",11),a(8),r(),o(9,"button",12),b("click",function(){E(e);let n=m();return D(n.onRefresh())}),a(10," Erneut versuchen "),r()()()}if(t&2){let e=m();s(8),P(e.error),s(),l("disabled",e.loading)}}function ge(t,d){if(t&1){let e=I();o(0,"div",2)(1,"div",3)(2,"div",13)(3,"div")(4,"h2",14),a(5),r(),o(6,"div",15),a(7),r()(),o(8,"button",16),b("click",function(){E(e);let n=m();return D(n.onRefresh())}),a(9," \u{1F504} Aktualisieren "),r()(),o(10,"div",17)(11,"span",18),a(12),T(13,"number"),r(),o(14,"span",19),a(15,"USD"),r()(),o(16,"div",20)(17,"span",21)(18,"strong"),a(19,"Aktualisiert:"),r(),a(20),r(),o(21,"span",22),a(22),T(23,"date"),r()()()()}if(t&2){let e=m();s(5),P(e.price.name),s(2),c(" ",e.price.symbol," "),s(),l("disabled",e.loading),s(4),P(F(13,6,e.price.price,"1.2-4")),s(8),c(" ",e.price.updatedAtReadable," "),s(2),c(" (",F(23,9,e.price.updatedAt,"medium"),") ")}}function fe(t,d){t&1&&(o(0,"div",2)(1,"div",23)(2,"div",24),a(3,"\u{1F4CA}"),r(),o(4,"p",25),a(5,"Keine Preisdaten verf\xFCgbar."),r()()())}var Q=(()=>{class t{price=null;loading=!1;error=null;refresh=new k;onRefresh(){this.refresh.emit()}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=g({type:t,selectors:[["app-price-card"]],inputs:{price:"price",loading:"loading",error:"error"},outputs:{refresh:"refresh"},standalone:!0,features:[f],decls:4,vars:4,consts:[["class","card",4,"ngIf"],["class","card border-danger",4,"ngIf"],[1,"card"],[1,"card-body"],[1,"skeleton-box","mb-2",2,"height","32px","width","60%"],[1,"skeleton-box","mb-3",2,"height","48px","width","40%"],[1,"skeleton-box",2,"height","20px","width","30%"],[1,"card","border-danger"],[1,"d-flex","align-items-center","mb-3"],[1,"text-danger","mr-2"],[1,"mb-0","text-danger"],[1,"mb-3"],[1,"btn","btn-outline-danger","btn-sm",3,"click","disabled"],[1,"d-flex","justify-content-between","align-items-start","mb-3"],[1,"h4","mb-1"],[1,"text-muted","text-uppercase","font-weight-bold",2,"letter-spacing","0.05em"],["title","Aktualisieren",1,"btn","btn-outline-primary","btn-sm",3,"click","disabled"],[1,"price-display","mb-3"],[1,"price-value"],[1,"price-currency","ml-2","text-muted"],[1,"text-muted","small"],[1,"mr-3"],[1,"text-muted",2,"font-size","0.85em"],[1,"card-body","text-center","py-5"],[1,"text-muted","mb-3",2,"font-size","3rem"],[1,"text-muted","mb-0"]],template:function(i,n){i&1&&v(0,ce,5,0,"div",0)(1,pe,11,2,"div",1)(2,ge,24,12,"div",0)(3,fe,6,0,"div",0),i&2&&(l("ngIf",n.loading),s(),l("ngIf",!n.loading&&n.error),s(),l("ngIf",!n.loading&&!n.error&&n.price),s(),l("ngIf",!n.loading&&!n.error&&!n.price))},dependencies:[u,w,z,U],styles:[".skeleton-box[_ngcontent-%COMP%]{background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_loading 1.5s infinite;border-radius:4px}@keyframes _ngcontent-%COMP%_loading{0%{background-position:200% 0}to{background-position:-200% 0}}.price-display[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:300;line-height:1.2}.price-value[_ngcontent-%COMP%]{font-family:Courier New,monospace}.price-currency[_ngcontent-%COMP%]{font-size:1.5rem;vertical-align:baseline}.card[_ngcontent-%COMP%]{box-shadow:0 2px 8px #0000001a;border:none}@media (max-width: 576px){.price-display[_ngcontent-%COMP%]{font-size:2rem}.price-currency[_ngcontent-%COMP%]{font-size:1.2rem}}"]})}return t})();var W=(()=>{class t{route=_(q);router=_(K);store=_(R);destroy$=new B;currentSymbol=C(()=>this.store.selectedSymbol());currentPrice=C(()=>this.store.selectedPrice());isLoading=C(()=>{let e=this.currentSymbol();return e?this.store.isLoadingPrice(e):!1});priceError=C(()=>{let e=this.currentSymbol(),i=this.currentPrice();return!this.isLoading()&&e&&!i?`Preis f\xFCr ${e} konnte nicht geladen werden.`:null});ngOnInit(){this.route.paramMap.pipe(j(this.destroy$)).subscribe(e=>{let i=e.get("symbol");if(i){let n=i.toUpperCase();this.loadSymbolData(n)}else this.router.navigate(["/market"])})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadSymbolData(e){return p(this,null,function*(){this.store.hasData()||(yield this.store.loadSymbols()),this.store.symbols().some(n=>n.symbol===e)||console.warn(`Symbol ${e} not found in available symbols`),yield this.store.selectSymbol(e)})}onRefresh(){return p(this,null,function*(){let e=this.currentSymbol();e&&(yield this.store.refreshPrice(e))})}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=g({type:t,selectors:[["app-asset-detail-page"]],standalone:!0,features:[f],decls:14,vars:4,consts:[[1,"asset-detail-page"],[1,"mb-3"],["routerLink","/market",1,"back-link"],[1,"page-header","mb-4"],[1,"page-title"],[3,"refresh","price","loading","error"],[1,"info-box","mt-4"],[1,"text-muted","small","mb-0"]],template:function(i,n){i&1&&(o(0,"div",0)(1,"div",1)(2,"a",2),a(3," \u2190 Zur\xFCck zur \xDCbersicht "),r()(),o(4,"div",3)(5,"h1",4),a(6),r()(),o(7,"app-price-card",5),b("refresh",function(){return n.onRefresh()}),r(),o(8,"div",6)(9,"p",7),a(10," \u{1F4A1} "),o(11,"strong"),a(12,"Tipp:"),r(),a(13,' Klicken Sie auf "Aktualisieren", um die neuesten Preisdaten zu laden. '),r()()()),i&2&&(s(6),c(" ",n.currentSymbol()||"Asset Details"," "),s(),l("price",n.currentPrice())("loading",n.isLoading())("error",n.priceError()))},dependencies:[u,L,Q],styles:[".asset-detail-page[_ngcontent-%COMP%]{max-width:900px;margin:0 auto;padding:2rem 1rem}.back-link[_ngcontent-%COMP%]{color:#667eea;text-decoration:none;font-weight:500;transition:color .2s}.back-link[_ngcontent-%COMP%]:hover{color:#764ba2;text-decoration:underline}.page-header[_ngcontent-%COMP%]{margin-bottom:2rem}.page-title[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;margin-bottom:0;color:#333}.info-box[_ngcontent-%COMP%]{background:#f8f9fa;border-left:4px solid #667eea;padding:1rem 1.5rem;border-radius:4px}@media (max-width: 768px){.asset-detail-page[_ngcontent-%COMP%]{padding:1.5rem 1rem}.page-title[_ngcontent-%COMP%]{font-size:1.5rem}}"]})}return t})();var rt=[{path:"",component:J,title:"Market"},{path:":symbol",component:W,title:"Asset"}];export{rt as MARKET_ROUTES};
