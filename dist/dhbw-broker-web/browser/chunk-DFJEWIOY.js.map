{
  "version": 3,
  "sources": ["src/app/core/auth/token-storage.service.ts"],
  "sourcesContent": ["// src/app/core/auth/token-storage.service.ts\nimport { Injectable, signal } from '@angular/core';\n\nconst ACCESS_TOKEN_KEY = 'access_token';\n\nexport interface DevJwtPayload {\n  sub: string;\n  email: string;\n  roles: string[];\n  iat: number;\n  exp: number;\n  firstName?: string;\n  lastName?: string;\n}\n\n@Injectable({ providedIn: 'root' })\nexport class TokenStorageService {\n  readonly token = signal<string | null>(this.get());\n\n  get(): string | null {\n    return localStorage.getItem(ACCESS_TOKEN_KEY);\n  }\n\n  set(token: string): void {\n    localStorage.setItem(ACCESS_TOKEN_KEY, token);\n    this.token.set(token);\n  }\n\n  clear(): void {\n    localStorage.removeItem(ACCESS_TOKEN_KEY);\n    this.token.set(null);\n  }\n\n  parsePayload(token: string | null): DevJwtPayload | null {\n    if (!token) return null;\n    const parts = token.split('.');\n    if (parts.length < 2) return null;\n    try {\n      const json = atob(parts[1].replace(/-/g, '+').replace(/_/g, '/'));\n      return JSON.parse(json);\n    } catch {\n      return null;\n    }\n  }\n\n  isExpired(token: string | null): boolean {\n    const p = this.parsePayload(token);\n    if (!p) return true;\n    const nowSec = Math.floor(Date.now() / 1000);\n    return p.exp <= nowSec;\n  }\n}\n"],
  "mappings": ";;;;;;AAGA,IAAM,mBAAmB;AAanB,IAAO,sBAAP,MAAO,qBAAmB;EACrB,QAAQ,OAAsB,KAAK,IAAG,CAAE;EAEjD,MAAG;AACD,WAAO,aAAa,QAAQ,gBAAgB;EAC9C;EAEA,IAAI,OAAa;AACf,iBAAa,QAAQ,kBAAkB,KAAK;AAC5C,SAAK,MAAM,IAAI,KAAK;EACtB;EAEA,QAAK;AACH,iBAAa,WAAW,gBAAgB;AACxC,SAAK,MAAM,IAAI,IAAI;EACrB;EAEA,aAAa,OAAoB;AAC/B,QAAI,CAAC;AAAO,aAAO;AACnB,UAAM,QAAQ,MAAM,MAAM,GAAG;AAC7B,QAAI,MAAM,SAAS;AAAG,aAAO;AAC7B,QAAI;AACF,YAAM,OAAO,KAAK,MAAM,CAAC,EAAE,QAAQ,MAAM,GAAG,EAAE,QAAQ,MAAM,GAAG,CAAC;AAChE,aAAO,KAAK,MAAM,IAAI;IACxB,QAAQ;AACN,aAAO;IACT;EACF;EAEA,UAAU,OAAoB;AAC5B,UAAM,IAAI,KAAK,aAAa,KAAK;AACjC,QAAI,CAAC;AAAG,aAAO;AACf,UAAM,SAAS,KAAK,MAAM,KAAK,IAAG,IAAK,GAAI;AAC3C,WAAO,EAAE,OAAO;EAClB;;qCAlCW,sBAAmB;EAAA;4EAAnB,sBAAmB,SAAnB,qBAAmB,WAAA,YADN,OAAM,CAAA;;",
  "names": []
}
