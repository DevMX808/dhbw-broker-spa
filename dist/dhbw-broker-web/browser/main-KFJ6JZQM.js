import{a as V}from"./chunk-S2BEGKDA.js";import{a as K}from"./chunk-FC6PIBBV.js";import{a as q}from"./chunk-AJAH6LSW.js";import{c as I,f as U,h as F,j as H,k as L,l as N,m as z,n as B,p as G,q as v,r as X,s as $,t as W,u as j}from"./chunk-GBTQ25J6.js";import{Ba as R,Ga as f,Ia as c,Ja as _,La as i,Ma as r,Na as A,Oa as O,P as w,Ra as D,Sa as x,V as d,X as s,Xa as a,a as T,b as k,c as C,cb as u,ea as P,fa as M,n as y,rb as h,va as m,x as E,y as S}from"./chunk-GMUHQ275.js";var J=(()=>{class t{static \u0275fac=function(e){return new(e||t)};static \u0275cmp=s({type:t,selectors:[["app-not-found"]],standalone:!0,features:[u],decls:5,vars:0,consts:[[1,"text-center","text-muted"],[1,"display-4"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"h1",1),a(2,"404"),r(),i(3,"p"),a(4,"Seite nicht gefunden."),r()())},encapsulation:2})}return t})();var Q=(()=>{class t{static \u0275fac=function(e){return new(e||t)};static \u0275cmp=s({type:t,selectors:[["app-unauthorized"]],standalone:!0,features:[u],decls:5,vars:0,consts:[[1,"text-center","text-muted"],[1,"h3"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"h1",1),a(2,"401"),r(),i(3,"p"),a(4,"Nicht berechtigt."),r()())},encapsulation:2})}return t})();var Y=(()=>{class t{static \u0275fac=function(e){return new(e||t)};static \u0275cmp=s({type:t,selectors:[["app-error"]],standalone:!0,features:[u],decls:5,vars:0,consts:[[1,"text-center","text-muted"],[1,"h3"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"h1",1),a(2,"Fehler"),r(),i(3,"p"),a(4,"Es ist ein unerwarteter Fehler aufgetreten."),r()())},encapsulation:2})}return t})();var Z=[{path:"",pathMatch:"full",redirectTo:"market"},{path:"account",loadChildren:()=>import("./chunk-IREOZNJQ.js").then(t=>t.ACCOUNT_ROUTES)},{path:"market",loadChildren:()=>import("./chunk-KUQBTXIT.js").then(t=>t.MARKET_ROUTES)},{path:"trade",loadChildren:()=>import("./chunk-KIA2IZMK.js").then(t=>t.TRADE_ROUTES)},{path:"portfolio",loadChildren:()=>import("./chunk-DGWHQDDD.js").then(t=>t.PORTFOLIO_ROUTES)},{path:"wallet",loadChildren:()=>import("./chunk-UZTVPVI5.js").then(t=>t.WALLET_ROUTES)},{path:"settings",loadChildren:()=>import("./chunk-FDWL7Q6W.js").then(t=>t.SETTINGS_ROUTES)},{path:"admin",loadChildren:()=>import("./chunk-RIGVZGFW.js").then(t=>t.ADMIN_ROUTES)},{path:"unauthorized",component:Q,title:"Unauthorized"},{path:"error",component:Y,title:"Error"},{path:"**",component:J,title:"Not Found"}];var tt=(t,l)=>{let n=d(q),e=new URL(t.url,document.baseURI),o=e.hostname==="localhost"&&(e.port==="8080"||e.pathname.startsWith("/api")||e.pathname.startsWith("/graphql"))||e.hostname==="rocky-atoll-88358-b10b362cee67.herokuapp.com"||e.hostname==="mysterious-gorge-04164-edc5a9f39d38.herokuapp.com"||e.pathname.startsWith("/api")||e.pathname.startsWith("/graphql"),p=n.get(),b=p&&!n.isExpired(p),it=e.pathname.startsWith("/auth");if(o&&b&&!t.headers.has("Authorization")&&!it){let at=t.clone({setHeaders:{Authorization:`Bearer ${p}`}});return l(at)}return l(t)};var et=(t,l)=>{let n=d(v);return l(t).pipe(S(e=>{if(e instanceof F){let o=e.status;o===401?t.url.includes("/auth/login")||t.url.includes("/auth/register")?console.warn("[HTTP] 401 on auth request - staying on current page"):(console.warn("[HTTP] 401 Unauthorized \u2192 redirect to /account"),n.navigateByUrl("/account")):o===403?(console.warn("[HTTP] 403 Forbidden \u2192 redirect to /unauthorized"),n.navigateByUrl("/unauthorized")):o===0?console.error("[HTTP] Netzwerkfehler (status 0).",e):o>=500?console.error(`[HTTP] Serverfehler ${o}.`,e):console.warn(`[HTTP] Fehler ${o}.`,e)}else console.error("[HTTP] Unbekannter Fehler:",e);return y(()=>e)}))};var nt=(()=>{class t{mockSymbols=[{name:"Silver",symbol:"XAG"},{name:"Gold",symbol:"XAU"},{name:"Bitcoin",symbol:"BTC"},{name:"Ethereum",symbol:"ETH"},{name:"Palladium",symbol:"XPD"},{name:"Copper",symbol:"HG"}];mockPrices={XAG:{name:"Silver",symbol:"XAG",price:34.52},XAU:{name:"Gold",symbol:"XAU",price:3952.699951},BTC:{name:"Bitcoin",symbol:"BTC",price:67234.89},ETH:{name:"Ethereum",symbol:"ETH",price:2845.32},XPD:{name:"Palladium",symbol:"XPD",price:1087.45},HG:{name:"Copper",symbol:"HG",price:4.23}};delay(n=300){return new Promise(e=>setTimeout(e,n))}fetchSymbols(){return C(this,null,function*(){return yield this.delay(400),[...this.mockSymbols]})}fetchPrice(n){return C(this,null,function*(){yield this.delay(300);let e=this.mockPrices[n];if(!e)throw new Error(`Symbol "${n}" not found`);let o=new Date,p=o.toISOString(),b=this.getReadableTimestamp(o);return k(T({},e),{updatedAt:p,updatedAtReadable:b})})}getReadableTimestamp(n){let e=Math.floor((Date.now()-n.getTime())/1e3);if(e<10)return"a few seconds ago";if(e<60)return`${e} seconds ago`;let o=Math.floor(e/60);if(o<60)return`${o} minute${o>1?"s":""} ago`;let p=Math.floor(o/60);return`${p} hour${p>1?"s":""} ago`}static \u0275fac=function(e){return new(e||t)};static \u0275prov=w({token:t,factory:t.\u0275fac})}return t})();var ot={providers:[W(Z,j()),H(N(),L([tt,et])),{provide:K,useClass:nt}]};function lt(t,l){t&1&&(i(0,"li",11)(1,"a",14),a(2," Portfolio "),r()())}function pt(t,l){t&1&&(i(0,"li",11)(1,"a",15),a(2," Handel "),r()())}function mt(t,l){t&1&&(i(0,"li",11)(1,"a",16),a(2," Admin "),r()())}function st(t,l){t&1&&(i(0,"li",11)(1,"a",17),a(2," Anmelden "),r()())}function ct(t,l){if(t&1){let n=O();i(0,"li",11)(1,"button",18),D("click",function(){P(n);let o=x(2);return M(o.logout())}),a(2," Abmelden "),r()()}}function ut(t,l){if(t&1&&(i(0,"nav",4)(1,"div",5)(2,"a",6),a(3," \u{1F4C8} Broker Demo "),r(),i(4,"button",7),A(5,"span",8),r(),i(6,"div",9)(7,"ul",10)(8,"li",11)(9,"a",12),a(10," Markt "),r()(),f(11,lt,3,0,"li",13)(12,pt,3,0,"li",13)(13,mt,3,0,"li",13)(14,st,3,0,"li",13)(15,ct,3,0,"li",13),r()()()()),t&2){let n=x();m(11),c("ngIf",n.isAuth()),m(),c("ngIf",n.isAuth()),m(),c("ngIf",n.isAuth()&&n.isAdmin()),m(),c("ngIf",!n.isAuth()),m(),c("ngIf",n.isAuth())}}function dt(t,l){t&1&&(i(0,"footer",19)(1,"small"),a(2,"\xA9 2025 Broker Demo | DHBW Webprogrammierung"),r()())}var rt=(()=>{class t{auth=d(V);router=d(v);isAuth=h(()=>this.auth.isAuthenticated());isAdmin=h(()=>this.auth.hasRole("ADMIN"));email=h(()=>this.auth.user()?.email??"");isAuthRoute=R(!1);constructor(){this.router.events.pipe(E(n=>n instanceof B)).subscribe(n=>{this.isAuthRoute.set(n.url.includes("/account"))}),this.isAuthRoute.set(this.router.url.includes("/account"))}logout(){this.auth.signOut()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=s({type:t,selectors:[["app-root"]],standalone:!0,features:[u],decls:5,vars:6,consts:[[1,"app-shell"],["class","navbar navbar-expand-lg navbar-light bg-white border-bottom",4,"ngIf"],[1,"app-content"],["class","app-footer text-center text-muted py-3 mt-5",4,"ngIf"],[1,"navbar","navbar-expand-lg","navbar-light","bg-white","border-bottom"],[1,"container-fluid"],["routerLink","/",1,"navbar-brand","font-weight-bold"],["type","button","data-toggle","collapse","data-target","#navbarNav",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarNav",1,"collapse","navbar-collapse"],[1,"navbar-nav","ml-auto"],[1,"nav-item"],["routerLink","/market","routerLinkActive","active",1,"nav-link"],["class","nav-item",4,"ngIf"],["routerLink","/portfolio","routerLinkActive","active",1,"nav-link"],["routerLink","/trade","routerLinkActive","active",1,"nav-link"],["routerLink","/admin","routerLinkActive","active",1,"nav-link"],["routerLink","/account",1,"nav-link"],[1,"btn","btn-sm","btn-outline-secondary","ml-2",3,"click"],[1,"app-footer","text-center","text-muted","py-3","mt-5"]],template:function(e,o){e&1&&(i(0,"div",0),f(1,ut,16,5,"nav",1),i(2,"main",2),A(3,"router-outlet"),r(),f(4,dt,3,0,"footer",3),r()),e&2&&(_("app-shell--fullscreen",o.isAuthRoute()),m(),c("ngIf",!o.isAuthRoute()),m(),_("container",!o.isAuthRoute()),m(2),c("ngIf",!o.isAuthRoute()))},dependencies:[U,I,G,X,$],styles:['.app-shell[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;margin:0;padding:0;background:#f8f9fa}.app-shell--fullscreen[_ngcontent-%COMP%]{overflow:hidden}.app-shell--fullscreen[_ngcontent-%COMP%]   .app-content[_ngcontent-%COMP%]{padding:0!important;margin:0!important;max-width:100%!important;width:100vw!important}.app-content[_ngcontent-%COMP%]{flex:1;background:#fff}.navbar[_ngcontent-%COMP%]{box-shadow:0 2px 4px #00000014}.navbar[_ngcontent-%COMP%]   .navbar-brand[_ngcontent-%COMP%]{font-size:1.25rem;color:#333}.navbar[_ngcontent-%COMP%]   .navbar-brand[_ngcontent-%COMP%]:hover{color:#667eea}.navbar[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{font-weight:500;color:#666;transition:color .2s;padding:.5rem 1rem}.navbar[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{color:#667eea}.navbar[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{color:#667eea;font-weight:600;position:relative}.navbar[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-1px;left:1rem;right:1rem;height:2px;background:#667eea}.app-footer[_ngcontent-%COMP%]{background:#f8f9fa;border-top:1px solid #e0e0e0;margin-top:3rem}']})}return t})();z(rt,ot).catch(t=>console.error(t));
